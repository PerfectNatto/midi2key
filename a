F = real_stft.size(1)                               # 周波数ビン数（定数でトレースされる）

idx = torch.arange(F - 2, 0, -1,                     # [F-2, … , 1]
                   device=real_stft.device, dtype=torch.long)

# ==== real 部 ====
rev_real       = real_stft.index_select(1, idx)      # Gather 相当
full_real_stft = torch.cat((real_stft, rev_real), dim=1)

# ==== imag 部 ====
rev_imag       = imag_stft.index_select(1, idx)
full_imag_stft = torch.cat((imag_stft, -rev_imag), dim=1)  # UnaryOp(neg) + Concat
